<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. Landsat image conversion to reflectance and DOS1 atmospheric correction &mdash; Semi-Automatic Classification Plugin 2.5.0 documentation</title>
    
    <link rel="stylesheet" href="_static//default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Semi-Automatic Classification Plugin 2.5.0 documentation" href="index.html" />
    <link rel="up" title="3.3. Main Interface Window" href="main_interface_window.html" />
    <link rel="next" title="4. Tutorials" href="Tutorials.html" />
    <link rel="prev" title="3.3. Main Interface Window" href="main_interface_window.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="Tutorials.html" title="4. Tutorials"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="main_interface_window.html" title="3.3. Main Interface Window"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Semi-Automatic Classification Plugin 2.5.0 documentation</a> &raquo;</li>
          <li><a href="Interface.html" >3. The Interface</a> &raquo;</li>
          <li><a href="main_interface_window.html" accesskey="U">3.3. Main Interface Window</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="landsat-image-conversion-to-reflectance-and-dos1-atmospheric-correction">
<span id="landsat-conversion-to-reflectance"></span><h1>1. Landsat image conversion to reflectance and DOS1 atmospheric correction<a class="headerlink" href="#landsat-image-conversion-to-reflectance-and-dos1-atmospheric-correction" title="Permalink to this headline">¶</a></h1>
<p>Radiance is the &#8220;flux of energy (primarily irradiant or incident energy) per solid angle leaving a unit surface area in a given direction&#8221;, &#8220;Radiance is what is measured at the sensor and is somewhat dependent on reflectance&#8221; (NASA, 2011, p. 47).
The Spectral Radiance at the sensor&#8217;s aperture (L<sub>λ</sub> ) is measured in [watts/(meter squared * ster * μm)] and for Landsat images it is given by (<a class="reference external" href="https://landsat.usgs.gov/Landsat8_Using_Product.php">https://landsat.usgs.gov/Landsat8_Using_Product.php</a>):</p>
<div class="math">
\[L_{λ} = M_{L} * Q_{cal} + A_{L}\]</div>
<p>where:</p>
<ul class="simple">
<li>M<sub>L</sub> = Band-specific multiplicative rescaling factor from Landsat metadata (RADIANCE_MULT_BAND_x, where x is the band number)</li>
<li>A<sub>L</sub> = Band-specific additive rescaling factor from Landsat metadata (RADIANCE_ADD_BAND_x, where x is the band number)</li>
<li>Q<sub>cal</sub> = Quantized and calibrated standard product pixel values (DN)</li>
</ul>
<p>&#8220;For relatively clear Landsat scenes, a reduction in between-scene variability can be achieved through a normalization for solar irradiance by converting spectral radiance, as calculated above, to planetary reflectance or albedo. This combined surface and atmospheric reflectance of the Earth is computed with the following formula&#8221; (NASA, 2011, p. 119):</p>
<div class="math">
\[ρ_{p} = (π * L_{λ} * d^{2} )/ (ESUN_{λ} * cosθ_{s})\]</div>
<p>where:</p>
<ul class="simple">
<li>ρ<sub>p</sub> = Unitless planetary reflectance, which is “the ratio of reflected versus total power energy” (NASA, 2011, p. 47)</li>
<li>L<sub>λ</sub> = Spectral radiance at the sensor&#8217;s aperture (at-satellite radiance)</li>
<li>d = Earth-Sun distance in astronomical units (provided with Landsat 8 metafile, and an excel file is available from <a class="reference external" href="http://landsathandbook.gsfc.nasa.gov/excel_docs/d.xls">http://landsathandbook.gsfc.nasa.gov/excel_docs/d.xls</a>)</li>
<li>ESUN<sub>λ</sub> = Mean solar exo-atmospheric irradiances</li>
<li>θ<sub>s</sub> = Solar zenith angle in degrees, which is equal to θ<sub>s</sub> = 90° - θ<sub>e</sub> where θ<sub>e</sub> is the Sun elevation</li>
</ul>
<p>It is worth pointing out that Landsat 8 images are provided with  band-specific rescaling factors that allow for the direct conversion from DN to TOA reflectance. However, the effects of the atmosphere (i.e. a disturbance on the reflectance that varies with the wavelenght) should be considered in order to measure the refletance at the ground. As described by Moran et al. (1992), the land surface reflectance (ρ) is:</p>
<div class="math">
\[ρ = [π * (L_{λ} - L_{p}) * d^{2}]/ [T_{v} * ( (ESUN_{λ} * cosθ_{s} * T_{z} ) + E_{down} )]\]</div>
<p>where:</p>
<ul class="simple">
<li>L<sub>p</sub> is the path radiance</li>
<li>T<sub>v</sub> is the atmospheric transmittance in the viewing direction</li>
<li>T<sub>z</sub> is the atmospheric transmittance in the illumination direction</li>
<li>E<sub>down</sub> is the downwelling diffuse irradiance</li>
</ul>
<p>Therefore, we need several atmospheric measurements in order to calculate ρ (physically-based corrections). Alternatively, it is possible to use image-based techniques for the calculation of these parameters, without in-situ measurements during image acquisition.</p>
<p>The Dark Object Subtraction (DOS) is a family of image-based atmospheric corrections.
Chavez (1996) explains that “the basic assumption is that within the image some pixels are in complete shadow and their radiances received at the satellite are due to atmospheric scattering (path radiance). This assumption is combined with the fact that very few targets on the Earth&#8217;s surface are absolute black, so an assumed one-percent minimum reflectance is better than zero percent”. It is worth pointing out that the accuracy of image-based techniques is generally lower than physically-based corrections, but they are very useful when no atmospheric measurements are available as they can improve the estimation of land surface reflectance.
The path radiance is given by (Sobrino, et al., 2004):</p>
<div class="math">
\[L_{p} = L_{min} – L_{DO1\%}\]</div>
<p>where:</p>
<ul class="simple">
<li>L<sub>min</sub> = “radiance that corresponds to a digital count value for which the sum of all the pixels with digital counts lower or equal to this value is equal to the 0.01% of all the pixels from the image considered” (Sobrino, et al., 2004, p. 437), therefore the radiance obtained with that digital count value (DN<sub>min</sub>)</li>
<li>L<sub>DO1%</sub> = radiance of Dark Object, assumed to have a reflectance value of 0.01</li>
</ul>
<p>Therfore for Landsat images:</p>
<div class="math">
\[Lmin = M_{L} * DN_{min} + A_{L}\]</div>
<p>The radiance of Dark Object is given by (Sobrino, et al., 2004):</p>
<div class="math">
\[L_{DO1\%} = 0.01 * [(ESUN_{λ} * cosθ_{s} * T_{z} ) + E_{down}] * T_{v} / (π * d^{2})\]</div>
<p>Therefore the path radiance is:</p>
<div class="math">
\[L_{p} = M_{L} * DN_{min} + A_{L} – 0.01* [(ESUN_{λ} * cosθ_{s} * T_{z} ) + E_{down}] * T_{v} / (π * d^{2})\]</div>
<p>There are several DOS techniques (e.g. DOS1, DOS2, DOS3, DOS4), based on different assumption about T<sub>v</sub>, T<sub>z</sub> , and E<sub>down</sub> .
The simplest technique is the DOS1, where the following assumptions are made (Moran et al., 1992):</p>
<ul class="simple">
<li>T<sub>v</sub> = 1</li>
<li>T<sub>z</sub> = 1</li>
<li>E<sub>down</sub> = 0</li>
</ul>
<p>Therefore the path radiance is:</p>
<div class="math">
\[L_{p} = M_{L} * DN_{min} + A_{L} – 0.01 * ESUN_{λ} * cosθ_{s} / (π * d^{2})\]</div>
<p>And the resulting land surface reflectance is given by:</p>
<div class="math">
\[ρ = [π * (L_{λ} - L_{p}) * d^{2}]/ (ESUN_{λ} * cosθ_{s})\]</div>
<p>ESUN [W /(m2 * μm)] values for Landsat sensors are provided in the following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="29%" />
<col width="33%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Band</th>
<th class="head">Landsat 4*</th>
<th class="head">Landsat 5**</th>
<th class="head">Landsat 7**</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>1957</td>
<td>1983</td>
<td>1997</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>1825</td>
<td>1769</td>
<td>1812</td>
</tr>
<tr class="row-even"><td>3</td>
<td>1557</td>
<td>1536</td>
<td>1533</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>1033</td>
<td>1031</td>
<td>1039</td>
</tr>
<tr class="row-even"><td>5</td>
<td>214.9</td>
<td>220</td>
<td>230.8</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>80.72</td>
<td>83.44</td>
<td>84.90</td>
</tr>
</tbody>
</table>
<p>* from Chander &amp; Markham (2003)</p>
<p>** from Finn, et al. (2012)</p>
<p><br />
For Landsat 8, ESUN can be calculated as (from <a class="reference external" href="http://grass.osgeo.org/grass65/manuals/i.landsat.toar.html">http://grass.osgeo.org/grass65/manuals/i.landsat.toar.html</a>):</p>
<div class="math">
\[ESUN = (π * d^{2}) * RADIANCE\_MAXIMUM / REFLECTANCE\_MAXIMUM\]</div>
<p>where RADIANCE_MAXIMUM and REFLECTANCE_MAXIMUM are provided by image metadata.</p>
<p><br /></p>
</div>
<div class="section" id="conversion-to-at-satellite-brightness-temperature">
<span id="landsat-conversion-to-temperature"></span><h1>2. Conversion to At-Satellite Brightness Temperature<a class="headerlink" href="#conversion-to-at-satellite-brightness-temperature" title="Permalink to this headline">¶</a></h1>
<p>For Landsat thermal bands, the conversion of DN to At-Satellite Brightness Temperature is given by (from <a class="reference external" href="https://landsat.usgs.gov/Landsat8_Using_Product.php">https://landsat.usgs.gov/Landsat8_Using_Product.php</a>):</p>
<div class="math">
\[T_{B} = K_{2} / ln[(K_{1} / L_{λ}) + 1]\]</div>
<p>where:</p>
<ul class="simple">
<li>K<sub>1</sub> = Band-specific thermal conversion constant (in watts/meter squared * ster * μm)</li>
<li>K<sub>2</sub> = Band-specific thermal conversion constant (in kelvin)</li>
</ul>
<p>and L<sub>λ</sub> is the Spectral Radiance at the sensor&#8217;s aperture, measured in watts/(meter squared * ster * μm); for Landsat images it is given by (from <a class="reference external" href="https://landsat.usgs.gov/Landsat8_Using_Product.php">https://landsat.usgs.gov/Landsat8_Using_Product.php</a>)</p>
<div class="math">
\[L_{λ} = M_{L} * Q_{cal} + A_{L}\]</div>
<p>where:</p>
<ul class="simple">
<li>M<sub>L</sub> = Band-specific multiplicative rescaling factor from Landsat metadata (RADIANCE_MULT_BAND_x, where x is the band number)</li>
<li>A<sub>L</sub> = Band-specific additive rescaling factor from Landsat metadata (RADIANCE_ADD_BAND_x, where x is the band number)</li>
<li>Q<sub>cal</sub> = Quantized and calibrated standard product pixel values (DN)</li>
</ul>
<p>The K<sub>1</sub> and K<sub>2</sub> constant for Landsat sensors are provided in the following table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="16%" />
<col width="18%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Constant</th>
<th class="head">Landsat 4*</th>
<th class="head">Landsat 5*</th>
<th class="head">Landsat 7**</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>K<sub>1</sub> (watts/meter squared * ster * μm)</td>
<td>671.62</td>
<td>607.76</td>
<td>666.09</td>
</tr>
<tr class="row-odd"><td>K<sub>2</sub> (Kelvin)</td>
<td>1284.30</td>
<td>1260.56</td>
<td>1282.71</td>
</tr>
</tbody>
</table>
<p>* from Chander &amp; Markham (2003)</p>
<p>** from NASA (2011)</p>
<p><br />
For Landsat 8, the K<sub>1</sub> and K<sub>2</sub> values are provided in the image metafile.</p>
<p><br />
<strong>References</strong></p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">Chander,</span> <span class="pre">G.</span> <span class="pre">&amp;</span> <span class="pre">Markham,</span> <span class="pre">B.</span> <span class="pre">2003.</span> <span class="pre">Revised</span> <span class="pre">Landsat-5</span> <span class="pre">TM</span> <span class="pre">radiometric</span> <span class="pre">calibration</span> <span class="pre">procedures</span> <span class="pre">and</span> <span class="pre">postcalibration</span> <span class="pre">dynamic</span> <span class="pre">ranges</span> <span class="pre">Geoscience</span> <span class="pre">and</span> <span class="pre">Remote</span> <span class="pre">Sensing,</span> <span class="pre">IEEE</span> <span class="pre">Transactions</span> <span class="pre">on,</span> <span class="pre">41,</span> <span class="pre">2674</span> <span class="pre">–</span> <span class="pre">2677</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Chavez,</span> <span class="pre">P.</span> <span class="pre">S.</span> <span class="pre">1996.</span> <span class="pre">Image-Based</span> <span class="pre">Atmospheric</span> <span class="pre">Corrections</span> <span class="pre">-</span> <span class="pre">Revisited</span> <span class="pre">and</span> <span class="pre">Improved</span> <span class="pre">Photogrammetric</span> <span class="pre">Engineering</span> <span class="pre">and</span> <span class="pre">Remote</span> <span class="pre">Sensing,</span> <span class="pre">[Falls</span> <span class="pre">Church,</span> <span class="pre">Va.]</span> <span class="pre">American</span> <span class="pre">Society</span> <span class="pre">of</span> <span class="pre">Photogrammetry,</span> <span class="pre">62,</span> <span class="pre">1025-1036</span></tt></li>
<li><tt class="docutils literal"><span class="pre">Finn,</span> <span class="pre">M.P.,</span> <span class="pre">Reed,</span> <span class="pre">M.D,</span> <span class="pre">and</span> <span class="pre">Yamamoto,</span> <span class="pre">K.H.</span> <span class="pre">2012.</span> <span class="pre">A</span> <span class="pre">Straight</span> <span class="pre">Forward</span> <span class="pre">Guide</span> <span class="pre">for</span> <span class="pre">Processing</span> <span class="pre">Radiance</span> <span class="pre">and</span> <span class="pre">Reflectance</span> <span class="pre">for</span> <span class="pre">EO-1</span> <span class="pre">ALI,</span> <span class="pre">Landsat</span> <span class="pre">5</span> <span class="pre">TM,</span> <span class="pre">Landsat</span> <span class="pre">7</span> <span class="pre">ETM+,</span> <span class="pre">and</span> <span class="pre">ASTER.</span> <span class="pre">Unpublished</span> <span class="pre">Report</span> <span class="pre">from</span> <span class="pre">USGS/Center</span> <span class="pre">of</span> <span class="pre">Excellence</span> <span class="pre">for</span> <span class="pre">Geospatial</span> <span class="pre">Information</span> <span class="pre">Science,</span> <span class="pre">8</span> <span class="pre">p</span></tt> , <a class="reference external" href="http://cegis.usgs.gov/soil_moisture/pdf/A%20Straight%20Forward%20guide%20for%20Processing%20Radiance%20and%20Reflectance_V_24Jul12.pdf">http://cegis.usgs.gov/soil_moisture/pdf/A%20Straight%20Forward%20guide%20for%20Processing%20Radiance%20and%20Reflectance_V_24Jul12.pdf</a></li>
<li><tt class="docutils literal"><span class="pre">Moran,</span> <span class="pre">M.;</span> <span class="pre">Jackson,</span> <span class="pre">R.;</span> <span class="pre">Slater,</span> <span class="pre">P.</span> <span class="pre">&amp;</span> <span class="pre">Teillet,</span> <span class="pre">P.</span> <span class="pre">1992.</span> <span class="pre">Evaluation</span> <span class="pre">of</span> <span class="pre">simplified</span> <span class="pre">procedures</span> <span class="pre">for</span> <span class="pre">retrieval</span> <span class="pre">of</span> <span class="pre">land</span> <span class="pre">surface</span> <span class="pre">reflectance</span> <span class="pre">factors</span> <span class="pre">from</span> <span class="pre">satellite</span> <span class="pre">sensor</span> <span class="pre">output</span> <span class="pre">Remote</span> <span class="pre">Sensing</span> <span class="pre">of</span> <span class="pre">Environment,</span> <span class="pre">41,</span> <span class="pre">169-184</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NASA</span> <span class="pre">(Ed.)</span> <span class="pre">2011.</span> <span class="pre">Landsat</span> <span class="pre">7</span> <span class="pre">Science</span> <span class="pre">Data</span> <span class="pre">Users</span> <span class="pre">Handbook</span> <span class="pre">Landsat</span> <span class="pre">Project</span> <span class="pre">Science</span> <span class="pre">Office</span> <span class="pre">at</span> <span class="pre">NASA's</span> <span class="pre">Goddard</span> <span class="pre">Space</span> <span class="pre">Flight</span> <span class="pre">Center</span> <span class="pre">in</span> <span class="pre">Greenbelt,</span> <span class="pre">186</span></tt> <a class="reference external" href="http://landsathandbook.gsfc.nasa.gov/pdfs/Landsat7_Handbook.pdf">http://landsathandbook.gsfc.nasa.gov/pdfs/Landsat7_Handbook.pdf</a></li>
<li><tt class="docutils literal"><span class="pre">Sobrino,</span> <span class="pre">J.;</span> <span class="pre">Jiménez-Muñoz,</span> <span class="pre">J.</span> <span class="pre">C.</span> <span class="pre">&amp;</span> <span class="pre">Paolini,</span> <span class="pre">L.</span> <span class="pre">2004.</span> <span class="pre">Land</span> <span class="pre">surface</span> <span class="pre">temperature</span> <span class="pre">retrieval</span> <span class="pre">from</span> <span class="pre">LANDSAT</span> <span class="pre">TM</span> <span class="pre">5</span> <span class="pre">Remote</span> <span class="pre">Sensing</span> <span class="pre">of</span> <span class="pre">Environment,</span> <span class="pre">Elsevier,</span> <span class="pre">90,</span> <span class="pre">434-440</span></tt></li>
</ul>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="Tutorials.html" title="4. Tutorials"
             >next</a></li>
        <li class="right" >
          <a href="main_interface_window.html" title="3.3. Main Interface Window"
             >previous</a> |</li>
        <li><a href="index.html">Semi-Automatic Classification Plugin 2.5.0 documentation</a> &raquo;</li>
          <li><a href="Interface.html" >3. The Interface</a> &raquo;</li>
          <li><a href="main_interface_window.html" >3.3. Main Interface Window</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Luca Congedo.
    </div>
  </body>
</html>